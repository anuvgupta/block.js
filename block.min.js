/*
 block.js v2.0
 (c) 2016 Anuv Gupta [http://anuv.me/block.js]
 License: MIT
*/
var __blocks={},__$block=!1;try{__$block="function"==typeof jQuery||"function"==typeof window.jQuery}catch(error){__$block=!1}var Block;Block=function(){var n,e,t,r,l,u,o={},s=arguments[0],a=arguments[1],c={},d={},f={__blockdata:[]};if(void 0!=a&&null!=a&&"function"==typeof a)return __blocks[s]={},__blocks[s].create=arguments[1],void 0!=arguments[2]&&null!=arguments[2]&&"function"==typeof arguments[2]&&(__blocks[s].load=arguments[2]),!0;var g=function(n,e){return"null"==e?null==n:"=null"==e?null===n:"undefined"==e?void 0==n:null===n||void 0==n?!1:"string"==e?"string"==typeof n||n instanceof String:"element"==e?g(n,"object")&&n instanceof Node&&n instanceof Element:"array"==e?"array"==typeof n||n instanceof Array:"object"==e?"object"==typeof n||n instanceof Object:"int"==e?n===parseInt(n,10)&&!isNaN(n):typeof n==e},m=function(n){return document.createElement(n)},v=function(n,e){return e.indexOf(n.trim().toLowerCase())>-1},h=function(n,e,t){return 1==e.length?(n[e[0]]=t,n):e.length>1?h(n[e[0]],e.slice(1),t):void 0},b=function(n,e){var t={},r=[],l=n.split("\n");for(i in l){var u=l[i],o=u.search(/\S/);if(-1!=o&&"//"!=u.substring(o,o+2)){u=u.substring(0,o)+u.substring(o).trim();var s=(u.match(new RegExp(e,"g"))||[]).length;u=u.trim();var a=u.search(/ /);if(-1==a)var c=u,d={};else var c=u.substring(0,a),d=u.substring(a+1);r=r.slice(0,s),r.push(c),h(t,r,d)}}return t};if((g(s,"null")||g(s,"undefined"))&&(s="block"),1==a)a=s;else if(g(a,"null")||g(a,"undefined")||0==a){for(a=Math.floor(1e4*Math.random()+1);g(c[a],"object");)a=Math.floor(1e3*Math.random()+1);a="_"+a.toString()}if(n={block:!0,add:function(){var n=[].slice.call(arguments),t=null;if(g(n[0],"undefined")||g(n[0],"null")||n[0].block===!0){n.length>=2&&(t=n[1],n=n.slice(0,1));var i=n[0]}else{n.length>=3&&(t=n[2],n=n.slice(0,2));var i=Block.apply(Block,n)}return c[i.mark()]=i,i.parent(this),g(e,"object")&&e.block?e.add(i,t):g(t,"string")&&g(c[t],"object")&&c[t].block?r.insertBefore(i.node(),c[t].node()):r.appendChild(i.node()),this},__add:function(){var n=[].slice.call(arguments),i=null;if(g(n[0],"undefined")||g(n[0],"null")||n[0].block===!0){n.length>=2&&(i=n[1],n=n.slice(0,1));var l=n[0]}else{n.length>=3&&(i=n[2],n=n.slice(0,2));var l=Block.apply(Block,n)}return d[l.mark()]=l,l.__parent(this),g(t,"object")&&t.block?e.__add(l,i):g(i,"string")&&g(d[i],"object")&&d[i].block?r.insertBefore(l.node(),d[i].node()):r.appendChild(l.node()),this},setAdd:function(n){return g(n,"object")&&n.block&&(e=n),this},__setAdd:function(n){return g(n,"object")&&n.block&&(t=n),this},remove:function(){return $marking=arguments[0],g($marking,"null")&&g($marking,"undefined")&&g(l,"null")&&g(l,"undefined")?l.remove(a):g($marking,"string")&&!g(c[$marking],"null")&&(g(e,"object")&&e.block?e.node().removeChild(c[$marking].node()):r.removeChild(c[$marking].node()),delete c[$marking]),this},__remove:function(){return $marking=arguments[0],g($marking,"null")&&g($marking,"undefined")&&g(u,"null")&&g(u,"undefined")?u.__remove(a):g($marking,"string")&&!g(d[$marking],"null")&&(g(t,"object")&&t.block?t.node().removeChild(d[$marking].node()):r.removeChild(d[$marking].node()),delete d[$marking]),this},empty:function(){for(var n in c)this.remove(n);return this},__empty:function(){for(var n in c)this.remove(n);return this},type:function(){var n=arguments[0];return g(n,"string")?(g(__blocks[n],"null")||g(__blocks[n],"undefined")||(s=n),this):s},"class":function(){return g(arguments[0],"string")?(r.className+=" "+arguments[0],this):r.className},id:function(){return g(arguments[0],"string")?(r.id=arguments[0],this):r.id},mark:function(){var n=arguments[0];return g(n,"string")?("css"==n?console.warn("[BLOCK] cannot mark as '"+n+"' (reserved)"):a=n,this):a},attribute:function(n){var e=arguments[1];return g(e,"string")?(r.setAttribute(n,e),this):r.getAttribute(n)},css:function(){var n=arguments[0];if(g(n,"object"))for($p in n)n.hasOwnProperty($p)&&g(n[$p],"string")&&(r.style[$p]=n[$p]);else{if(!g(n,"string")){var e={},t=r.style;for($prop in t)!t.hasOwnProperty($prop)||""==t[$prop]||!isNaN(parseFloat($prop))&&isFinite($prop)||(e[$prop]=t[$prop]);return e}if($value=arguments[1],!g($value,"string"))return r.style[n];r.style[n]=$value}return this},key:function(n){if($data=arguments[1],g($data,"undefined")||g($data,"null")){if(!g(f[n],"undefined")&&!g(f[n],"null"))return f[n];f[n]={}}else f[n]=$data;return this},on:function(n,e){var t=this;if(g(n,"string"))if(g(e,"function"))if(g(arguments[2],"string")){var i=arguments[2],l=n+"_"+i;g(o[n],"object")||(o[n]={}),o[n][i]=e,r.addEventListener(l,e,!1),o[l]=function(e){var r=e.detail;g(e.detail,"null")||g(e.detail,"undefined")?t.on(n,i):t.on(n,i,r)},r.addEventListener(n,o[l],!1)}else r.addEventListener(n,e,!1);else g(e,"string")?l=n+"_"+e:(g(e,"null")||g(e,"undefined")||g(e,"object"))&&(l=n),$data=arguments[arguments.length-1],(g($data,"null")||g($data,"undefined")||g($data,"string")||!g($data,"object"))&&($data={}),document.createEvent?($event=document.createEvent("CustomEvent"),$event.initCustomEvent(l,!0,!0,$data),r.dispatchEvent($event)):($event=document.createEventObject(),$event.eventType=l,r.fireEvent("on"+l,$event));return this},off:function(n,e){var t=o[n+"_"+e],i=null;return g(o[n],"null")||g(o[n],"undefined")||(i=o[n][e]),g(t,"function")&&(o[n+"_"+e]=null,r.removeEventListener(n,t)),g(i,"function")&&(o[n][e]=null,r.removeEventListener(n,i)),this},child:function(n){return g(n,"string")?n.includes("/")?c[n.substring(0,n.indexOf("/"))].child(n.substring(n.indexOf("/")+1)):g(c[n],"null")||g(c[n],"undefined")?null:c[n]:null},children:function(){return c},childCount:function(){var n=0;for(var e in c)n++;return n},__child:function(n){return g(n,"string")?n.includes("/")?d[n.substring(0,n.indexOf("/"))].__child(n.substring(n.indexOf("/")+1)):g(d[n],"null")||g(d[n],"undefined")?null:d[n]:null},__children:function(){return d},__childCount:function(){var n=0;for(var e in d)n++;return n},sibling:function(n){return null!=l&&void 0!=l?l.child(n):null},siblings:function(){return null!=l&&void 0!=l?l.children():null},siblingCount:function(){return null!=l&&void 0!=l?l.childCount():null},__sibling:function(n){return null!=u&&void 0!=u?u.__child(n):null},__siblings:function(){return null!=u&&void 0!=u?u.__children():null},__siblingCount:function(){return null!=u&&void 0!=u?u.__childCount():null},parent:function(){var n=arguments[0];return g(n,"object")&&n.block&&g(l,"undefined")&&g(l,"null")?(l=n,this):!g(n,"int")||g(l,"undefined")||g(l,"null")?g(l,"undefined")||g(l,"null")?null:l:0==n?l:l.parent(n-1)},__parent:function(){var n=arguments[0];return g(n,"object")&&n.block&&g(u,"undefined")&&g(u,"null")?(u=n,this):!g(n,"int")||g(u,"undefined")||g(u,"null")?g(u,"undefined")||g(u,"null")?null:u:0==n?u:u.__parent(n-1)},node:function(){return r},fill:function(n){return g(n,"object")&&n.block?(n.empty(),n=n.node()):g(n,"string")&&(n=document.querySelector(n)),g(n,"element")&&(n.innerHTML="",n.appendChild(r)),this},jQuery:function(){if(__$block){var n=this;return jQuery.extend(jQuery(r),{block:function(){return n}})}return console.warn("jQuery not detected"),null},$:function(){return this.jQuery()},data:function(n){var e={},t={},i=[];if(g(n,"object"))for($key in n)n.hasOwnProperty($key)&&("css"==$key?(t=n.css,i.push("css")):g(n[$key],"object")&&g(c[$key],"object")?(c[$key].data(n[$key]),i.push($key)):(g(n[$key],"object")&&i.push($key),e[$key]=n[$key]));else if(g(n,"string")||g(n,"int"))e={val:n};else{if(!g(n,"null")&&g(n,"object"))return this;e={}}if("block"!=s&&!g(__blocks[s],"undefined")&&!g(__blocks[s],"null")){var l=function(n){return"this"==n?e:g(e[n],"undefined")||g(e[n],"null")?null:(i.push(n),e[n])},u=function(n){return"this"==n?t:g(t[n],"undefined")||g(t[n],"null")?null:t[n]};__blocks[s].load(this,l,u)}for($property in t)t.hasOwnProperty($property)&&(r.style[$property]=t[$property]);for($key in e)e.hasOwnProperty($key)&&!v($key,i)&&r.setAttribute($key,e[$key]);return f.__blockdata.push({data:e,css:t}),this},parse:function(n,e){e=e.replace(/\r\n|\r|\n/g,"\n");var t=e.substring(0,e.indexOf("*")),r=b(e.substring(e.indexOf("*")+2),t);return this.data(r[a]),g(n,"function")&&n(this),this},load:function(n,e){var t=this,r=function(n,e){t.parse.apply(t,[n,e])},i=arguments[2],l=arguments[3];if((null==l||void 0==l)&&(l=!0),g(i,"string")&&"jquery"===i.toLowerCase())__$block?jQuery.ajax({url:e+".block",type:"GET",async:l,success:function(e){r(n,e)}}):console.warn("jQuery not detected");else if(i===!0){var u;u=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),u.onreadystatechange=function(){4==u.readyState&&200==u.status&&r(n,u.responseText)},u.open("GET",e+".block",l),u.send()}else r(n,customBlockData[e]);return this}},"block"==s){r=m("div"),r.className="block";var k=Block("div")["class"]("content").mark("content");n.setAdd(k),n.__add(k),n.__setAdd(k)}else null!=__blocks[s]?(n=__blocks[s].create(),n.type(s),n.mark(a)):r=m(s);return n};var $s=document.createElement("style");$s.type="text/css",$s.innerHTML=".block { width: 100%; height: 100%; display: table; text-align: center; } .block .content { display: table-cell; vertical-align: middle; text-align: center; margin: 0 auto; }",document.getElementsByTagName("head")[0].appendChild($s),$s=null;
