/*
  block.js v3.0
  [http://anuv.me/block.js]
  File: block.min.js (block.js minified)
  Source: [https://github.com/anuvgupta/block.js]
  License: MIT [https://github.com/anuvgupta/block.js/blob/v3/LICENSE.md]
  Copyright: (c) 2016 Anuv Gupta
*/
var Block;Block=function(){var block,addblock,__addblock,element,events={},customEvents={},type=arguments[0],marking=arguments[1],parent,__parent,children={},__children={},keys={},blockdata={count:0},dataBindings={},mediaQueries={},resizeQuery;if(void 0!=marking&&null!=marking&&"function"==typeof marking)return Block.blocks[type]={},Block.blocks[type].create=arguments[1],void 0!=arguments[2]&&null!=arguments[2]&&"function"==typeof arguments[2]&&(Block.blocks[type].load=arguments[2]),!0;var Is=Block.is;if(Is.unset(type)&&(type="block"),1==marking)marking=type;else if(Is.unset(marking)||0==marking)do marking="_"+Math.floor(1e3*Math.random()+1).toString();while(Is.obj(children[marking]));if(block={block:!0,add:function(){var a=[].slice.call(arguments),b=null;if(Is.set(a[0])&&a[0].block!==!0){a.length>=3&&(b=a[2],a=a.slice(0,2));var c=Block.apply(Block,a)}else{a.length>=2&&(b=a[1],a=a.slice(0,1));var c=a[0]}return children[c.mark()]=c,c.parent(this),Is.obj(addblock)&&addblock.block?addblock.add(c,b):Is.str(b)&&Is.obj(children[b])&&children[b].block?element.insertBefore(c.node(),children[b].node()):element.appendChild(c.node()),this},__add:function(){var a=[].slice.call(arguments),b=null;if(Is.set(a[0])&&a[0].block!==!0){a.length>=3&&(b=a[2],a=a.slice(0,2));var c=Block.apply(Block,a)}else{a.length>=2&&(b=a[1],a=a.slice(0,1));var c=a[0]}return __children[c.mark()]=c,c.__parent(this),Is.obj(__addblock)&&__addblock.block?addblock.__add(c,b):Is.str(b)&&Is.obj(__children[b])&&__children[b].block?element.insertBefore(c.node(),__children[b].node()):element.appendChild(c.node()),this},setAdd:function(a){return Is.obj(a)&&a.block&&(addblock=a),this},__setAdd:function(a){return Is.obj(a)&&a.block&&(__addblock=a),this},remove:function(){return $marking=arguments[0],Is.null($marking)&&Is.undef($marking)&&Is.null(parent)&&Is.undef(parent)?parent.remove(marking):Is.str($marking)&&!Is.null(children[$marking])&&(Is.obj(addblock)&&addblock.block?addblock.node().removeChild(children[$marking].node()):element.removeChild(children[$marking].node()),delete children[$marking]),this},__remove:function(){return $marking=arguments[0],Is.null($marking)&&Is.undef($marking)&&Is.null(__parent)&&Is.undef(__parent)?__parent.__remove(marking):Is.str($marking)&&!Is.null(__children[$marking])&&(Is.obj(__addblock)&&__addblock.block?__addblock.node().removeChild(__children[$marking].node()):element.removeChild(__children[$marking].node()),delete __children[$marking]),this},empty:function(){for(var a in children)this.remove(a);return this},__empty:function(){for(var a in children)this.remove(a);return this},type:function(){var a=arguments[0];return Is.str(a)?(Is.set(Block.blocks[a])&&(type=a),this):type},class:function(){return Is.str(arguments[0])?(element.className+=" "+arguments[0],this):element.className},id:function(){return Is.str(arguments[0])?(element.id=arguments[0],this):element.id},mark:function(){var a=arguments[0];return Is.str(a)?("css"==a?console.warn("[BLOCK] cannot mark as '"+a+"' (reserved)"):marking=a,this):marking},attribute:function(a){var b=arguments[1];return Is.str(b)?(element.setAttribute(a,b),this):element.getAttribute(a)},css:function(){var a=arguments[0];if(Is.obj(a))for($p in a)a.hasOwnProperty($p)&&Is.str(a[$p])&&(element.style[$p]=a[$p]);else{if(!Is.str(a)){var b={},c=element.style;for($prop in c)!c.hasOwnProperty($prop)||""==c[$prop]||!isNaN(parseFloat($prop))&&isFinite($prop)||(b[$prop]=c[$prop]);return b}if($value=arguments[1],!Is.str($value))return element.style[a];element.style[a]=$value}return this},key:function(a){if($data=arguments[1],Is.unset($data)){if(Is.str(a)||!Is.obj(a))return Is.unset(keys[a])?null:keys[a];for($subkey in a)a.hasOwnProperty($subkey)&&(keys[$subkey]=a[$subkey])}else keys[a]=$data;return this},blockdata:function(a){return Is.unset(blockdata[a])?null:blockdata[a]},on:function(a,b){var c=this;if(Is.str(a))if(Is.func(b))if($newCallback=function(a){a.detail;Is.unset(a.detail)?b(a,c,{}):b(a,c,a.detail)},Is.str(arguments[2])){var d=arguments[2],e=a+"_"+d;Is.obj(events[a])||(events[a]={}),events[a][d]=function(a){$newCallback(a)},element.addEventListener(e,events[a][d],!1),events[e]=function(b){var e=b.detail;Is.unset(b.detail)?c.on(a,d,{}):c.on(a,d,e)},element.addEventListener(a,events[e],!1)}else element.addEventListener(a,$newCallback,!1);else e=Is.str(b)?a+"_"+b:a,$data=arguments[arguments.length-1],!Is.unset($data)&&Is.obj($data)||($data={}),window.CustomEvent?($event=new CustomEvent(e,{detail:$data,bubbles:!0,cancelable:!0}),element.dispatchEvent($event)):document.createEvent?($event=document.createEvent("Event"),$event.initEvent(e,!0,!0,$data),element.dispatchEvent($event)):document.createEventObject?($event=document.createEventObject(),$event.eventType=e,$event.detail=$data,element.fireEvent("on"+e,$event),console.warn("Event bubbling and data not fully supported")):console.warn("Events not fully supported");return this},off:function(a,b){var c=events[a+"_"+b],d=null;return Is.set(events[a])&&(d=events[a][b]),Is.func(c)&&(events[a+"_"+b]=null,element.removeEventListener(a,c)),Is.func(d)&&(events[a][b]=null,element.removeEventListener(a+"_"+b,d)),this},child:function(a){if(Is.str(a)){if(!a.includes("/"))return Is.set(children[a])?children[a]:null;var b=a.substring(0,a.indexOf("/"));if(Is.set(children[b]))return children[b].child(a.substring(a.indexOf("/")+1))}return null},children:function(){return children},childCount:function(){var a=0;for(var b in children)a++;return a},__child:function(a){return Is.str(a)?a.includes("/")?__children[a.substring(0,a.indexOf("/"))].__child(a.substring(a.indexOf("/")+1)):Is.set(__children[a])?__children[a]:null:null},__children:function(){return __children},__childCount:function(){var a=0;for(var b in __children)a++;return a},sibling:function(a){return null!=parent&&void 0!=parent?parent.child(a):null},siblings:function(){return null!=parent&&void 0!=parent?parent.children():null},siblingCount:function(){return null!=parent&&void 0!=parent?parent.childCount():null},__sibling:function(a){return null!=__parent&&void 0!=__parent?__parent.__child(a):null},__siblings:function(){return null!=__parent&&void 0!=__parent?__parent.__children():null},__siblingCount:function(){return null!=__parent&&void 0!=__parent?__parent.__childCount():null},parent:function(){var a=arguments[0];return Is.obj(a)&&a.block&&Is.unset(parent)?(parent=a,this):Is.int(a)&&Is.set(a)?0==a?parent:parent.parent(a-1):Is.unset(parent)?null:parent},__parent:function(){var a=arguments[0];return Is.obj(a)&&a.block&&Is.unset(__parent)?(__parent=a,this):Is.int(a)&&Is.set(__parent)?0==a?__parent:__parent.__parent(a-1):Is.unset(__parent)?null:__parent},html:function(){var a=arguments[0],b=arguments[1];return Is.str(a)?(Is.set(b)&&b===!0?element.innerHTML+=a:element.innerHTML=a,this):element.innerHTML},node:function(){return element},fill:function(a){return Is.obj(a)&&a.block?(a.empty(),a=a.node()):Is.str(a)&&(a=document.querySelector(a)),Is.elem(a)&&(a.innerHTML="",a.appendChild(element)),this},jQuery:function(){if(Block.jQuery){var a=this;return jQuery.extend(jQuery(element),{block:function(){return a}})}return console.warn("jQuery not detected"),null},$:function(){return this.jQuery()},query:function(a,b){if(Is.str(a)){var c;if(Is.func(b))c=b.toString().match(/function[^{]+\{([\s\S]*)\}$/)[1];else{if(!Is.str(b))return this;c=b}$objectToEnd=a,$propertyToEnd=$objectToEnd.substring($objectToEnd.search(/ /)+1),$conditionToEnd=$propertyToEnd.substring($propertyToEnd.search(/ /)+1),$object=$objectToEnd.substring(0,$objectToEnd.search(/ /)).trim(),$property=$propertyToEnd.substring(0,$propertyToEnd.search(/ /)).trim(),$condition=$conditionToEnd.trim(),"window"==$object&&("height"==$property?$property="innerHeight":"width"==$property&&($property="innerWidth")),c="if ("+$object+"."+$property+" "+$condition+") { "+c+" }",Is.obj(mediaQueries[$object])?Is.arr(mediaQueries[$object][$property])||(mediaQueries[$object][$property]=[]):(mediaQueries[$object]={},mediaQueries[$object][$property]=[]),mediaQueries[$object][$property].unshift(c)}else resizeQuery(new CustomEvent(marking+"_query_"+Math.floor(Date.now()/1e3).toString()));return this},data:function($blockdata){var $data={},$style={},$reservedAttributes=[];if(Is.obj($blockdata)){if($reservedAttributes.push("__keys"),Is.arr($blockdata.__keys))var $iterableKeys=$blockdata.__keys;else var $iterableKeys=Object.keys($blockdata);for(var $j=0;$j<$iterableKeys.length;$j++){var $key=$iterableKeys[$j];if($blockdata.hasOwnProperty($key)){var $midspace=$key.search(/ /);if("css"==$key)$style=$blockdata.css,$reservedAttributes.push("css");else if("__js"==$key)eval("/* block.js auto-generated JS clause\n    (temporary event callback)\n   block type = "+type+"\n   block marking = "+marking+"\n*/\nvar $callback = function (event, block, data) {\n\n"+$blockdata.__js+"\n\n};"),this.on("__temp_event",$callback,"__rand"),this.on("__temp_event","__rand"),this.off("__temp_event","__rand"),$reservedAttributes.push("__js");else if(":"==$key.substring(0,1)){$reservedAttributes.push($key);var $dataToLoad=$blockdata[$key],$eventTypes=$key.substring(1),$eventCallback="";Is.str($dataToLoad.__js)&&($eventCallback+=$dataToLoad.__js,delete $dataToLoad.__js),Is.set($dataToLoad)&&($dataToLoad=JSON.stringify($dataToLoad),$eventCallback+=Is.str(arguments[1])?" block.data("+$dataToLoad+', "'+arguments[1]+'");':" block.data("+$dataToLoad+");"),eval("/* block.js auto-generated event listener\n    (event listener callback)\n   block type = "+type+"\n   block marking = "+marking+"\n   events = "+$eventTypes+"\n*/\nvar $callback = function (event, block, data) {\n\n"+$eventCallback+"\n\n};"),$eventTypes=$eventTypes.split(","),$eventTypes.forEach(function(a){this.on(a.trim(),$callback)},this)}else if("@"==$key.substring(0,1))$reservedAttributes.push($key),$key.length>6&&"query"==$key.substring(1,6)&&($dataToLoad=$blockdata[$key],$callbackJS="",Is.str($dataToLoad.__js)&&($callbackJS+=$dataToLoad.__js,delete $dataToLoad.__js),Is.set($dataToLoad)&&($dataToLoad=JSON.stringify($dataToLoad),Is.str(arguments[1])?$callbackJS+=" block.data("+$dataToLoad+', "'+arguments[1]+'");':$callbackJS+=" block.data("+$dataToLoad+");"),$query=$key.substring(7),this.query($query,$callbackJS));else if("!"==$key.substring(0,1)){$reservedAttributes.push($key);var $type=$key.substring(1),$initJS="",$callbacks=$blockdata[$key];Is.obj($callbacks.init)&&Is.str($callbacks.init.__js)&&($initJS=$callbacks.init.__js),eval("/* block.js auto-generated custom block initialization\n    (initialization callback)\n   custom block type = "+$type+"\n*/\nvar $initCallback = function () {\n\n"+$initJS+"\n\n};");var $dataJS="";Is.obj($callbacks.load)&&Is.str($callbacks.load.__js)&&($dataJS=$callbacks.load.__js),eval("/* block.js auto-generated custom block data loading\n    (data loading callback)\n   custom block type = "+$type+"\n*/\nvar $dataCallback = function (block, data, style) {\n\n"+$dataJS+"\n\n};"),Block($type,$initCallback,$dataCallback)}else if("$"==$key.substring(0,1))$reservedAttributes.push($key),this.key($key.substring(1),$blockdata[$key]);else if($midspace>0){var $childtype=$key.substring(0,$midspace),$childmarking=$key.substring($midspace+1),$childblock=Block($childtype,$childmarking);Is.obj($blockdata[$key])&&(Is.str(arguments[1])?$childblock.data($blockdata[$key],arguments[1]):$childblock.data($blockdata[$key]),$reservedAttributes.push($key)),this.add($childblock,Is.set($iterableKeys[$j+1])?$iterableKeys[$j+1]:null),$reservedAttributes.push($key)}else Is.obj($blockdata[$key])&&Is.obj(children[$key])?(Is.str(arguments[1])?children[$key].data($blockdata[$key],arguments[1]):children[$key].data($blockdata[$key]),$reservedAttributes.push($key)):(Is.obj($blockdata[$key])&&$reservedAttributes.push($key),$data[$key]=$blockdata[$key])}}}else if(Is.str($blockdata)||Is.int($blockdata))$data={val:$blockdata};else{if(!Is.null($blockdata)&&Is.obj($blockdata))return this;$data={}}if("block"!=type&&Is.set(Block.blocks[type])){var $getData=function(a,b){var c;return"this"==a?c=$data:Is.unset($data[a])?c=null:($reservedAttributes.push(a),c=$data[a]),Is.func(b)&&Is.set(c)&&b(c),c},$getStyle=function(a,b){var c;return c="this"==a?$style:Is.unset($style[a])?null:$style[a],Is.func(b,"function")&&Is.set(c)&&b(c),c};Block.blocks[type].load(this,$getData,$getStyle)}for($property in $style)$style.hasOwnProperty($property)&&(element.style[$property]=$style[$property]);for($key in dataBindings)dataBindings.hasOwnProperty($key)&&$data.hasOwnProperty($key)&&dataBindings[$key]($data[$key],this);for($key in $data)$data.hasOwnProperty($key)&&!Block.inArr($key,$reservedAttributes)&&element.setAttribute($key,$data[$key]);return blockdata.count++,blockdata[Is.str(arguments[1])?arguments[1]:"#"+blockdata.count]={data:$data,css:$style},this},bind:function(a,b){return Is.str(a)&&Is.func(b)&&(dataBindings[a]=b),this},parse:function(a,b){b=b.replace(/\r\n|\r|\n/g,"\n");var c=b.substring(0,b.indexOf("*")),d=Block.parse(b.substring(b.indexOf("*")+2),c);if(arguments[arguments.length-1]===!0)return d;$outsideData={};for($prop in d)d.hasOwnProperty($prop)&&$prop!=marking&&($outsideData[$prop]=d[$prop]);return Block("u").data($outsideData),Is.str(arguments[2])?this.data(d[marking],arguments[2]):this.data(d[marking]),Is.func(a)&&a(this),this},load:function(a,b){var c=this,d=function(a,d){c.parse.apply(c,[a,d,b])},e=arguments[2],f=arguments[3];if(null!=f&&void 0!=f||(f=!0),Is.str(e)&&"jquery"===e.toLowerCase())Block.jQuery?jQuery.ajax({url:b+".block",type:"GET",async:f,success:function(b){d(a,b)}}):console.warn("jQuery not detected");else if(e===!0){var g;window.XMLHttpRequest?g=new XMLHttpRequest:window.ActiveXObject?g=new ActiveXObject("Microsoft.XMLHTTP"):console.warn("XHR (XMLHttpRequest) not supported"),g.onreadystatechange=function(){4==g.readyState&&200==g.status&&d(a,g.responseText)},g.open("GET",b+".block",f),g.send()}else d(a,customBlockData[b]);return this}},"block"==type){element=Block.node("div"),block.css({width:"100%",height:"100%",display:"table",textAlign:"center"});var content=Block("div").mark("content").css({display:"table-cell",textAlign:"center",verticalAlign:"middle",margin:"0 auto"});block.setAdd(content).__add(content)}else null!=Block.blocks[type]?block=Block.blocks[type].create().type(type).mark(marking):element=Block.node(type);return block.attribute("block",marking),resizeQuery=function($e){$callback="";for($objectName in mediaQueries)if(mediaQueries.hasOwnProperty($objectName)){$object=mediaQueries[$objectName];for($propertyName in $object)if($object.hasOwnProperty($propertyName)){$property=$object[$propertyName];for($i in $property)0==$i?$callback+=" "+$property[$i]:$callback+=" else "+$property[$i]}}eval("/* block.js auto-generated media query\n    (window resize event callback)\n   block type = "+type+"\n   block marking = "+marking+"\n*/\n$callback = function (event, block, data) {\n\n"+$callback+"\n\n};"),Is.unset($e.detail)?$callback($e,block,{}):$callback($e,block,$e.detail)},window.addEventListener("blockjs_query",resizeQuery),block},Block.is={null:function(a){return null==a},eqnull:function(a){return null===a},undef:function(a){return void 0==a},set:function(a){return void 0!=a&&null!==a},unset:function(a){return void 0==a||null===a},str:function(a){return null!==a&&void 0!=a&&("string"==typeof a||a instanceof String)},func:function(a){return null!==a&&void 0!=a&&("function"==typeof a||a instanceof Function)},node:function(a){return null!==a&&void 0!=a&&("object"==typeof a||a instanceof Object)&&a instanceof Node},elem:function(a){return null!==a&&void 0!=a&&("object"==typeof a||a instanceof Object)&&a instanceof Node&&a instanceof Element},arr:function(a){return null!==a&&void 0!=a&&("array"==typeof a||a instanceof Array)},obj:function(a){return null!==a&&void 0!=a&&("object"==typeof a||a instanceof Object)},int:function(a){return null!==a&&void 0!=a&&a===parseInt(a,10)&&!isNaN(a)},type:function(a,b){return typeof a==b}},Block.node=function(a){return document.createElement(a)},Block.inArr=function(a,b){return b.indexOf(a)>-1},Block.set=function(a,b,c){return 1==b.length?(a[b[0]]=c,a):b.length>1?Block.set(a[b[0]],b.slice(1),c):void 0},Block.get=function(a,b){return 1==b.length?a[b[0]]:b.length>1?Block.get(a[b[0]],b.slice(1)):void 0},Block.parse=function(a,b){for(var c={},d=[],e=a.split("\n"),f=0;f<e.length;f++){var g=e[f],h=g.search(/\S/);if(h!=-1&&"//"!=g.substring(h,h+2)){g=g.substring(0,h)+g.substring(h).trim();var i=(g.match(new RegExp(b,"g"))||[]).length;g=g.trim();var j=g.search(/ /);if(j==-1||":"==g.substring(0,1)||"@"==g.substring(0,1)){var k=g,l={};if("{"==k){for(var m="",n=f+1;n<e.length;n++){var o=e[n],q=(o.search(/\S/),(o.match(new RegExp(b,"g"))||[]).length);if(o=o.trim(),"}"==o&&q==i)break;m+=o+"\n "}f=n,k="__js",l=m}}else if(Block.is.str(e[f+1])&&h<e[f+1].search(/\S/))var k=g,l={};else var k=g.substring(0,j),l=g.substring(j+1);d=d.slice(0,i);var r=d.concat(["__keys"]);Block.is.arr(Block.get(c,r))?Block.get(c,r).push(k):Block.set(c,r,[k]),d.push(k),Block.set(c,d,l)}}return c},Block.jQuery=!1;try{Block.jQuery="function"==typeof jQuery||"function"==typeof window.jQuery}catch(a){Block.jQuery=!1}Block.blocks={},Block.queries=function(a){"on"===a?window.addEventListener("resize",Block.queryListener):"off"===a?window.removeEventListener("resize",Block.queryListener):window.dispatchEvent(new CustomEvent("blockjs_query"))},Block.queryListener=function(){Block.queries()},Block.queries("on");
