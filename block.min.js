/*
  block.js v3.0
  [http://anuv.me/block.js]
  File: block.min.js (block.js minified)
  Source: [https://github.com/anuvgupta/block.js]
  License: MIT [https://github.com/anuvgupta/block.js/blob/v3/LICENSE.md]
  Copyright: (c) 2016 Anuv Gupta
*/
var Block;Block=function(){var block,addblock,__addblock,element,events={},customEvents={},type=arguments[0],marking=arguments[1],parent,__parent,children={},__children={},keys={},blockdata={count:0},dataBindings={},mediaQueries={};if(void 0!=marking&&null!=marking&&"function"==typeof marking)return Block.blocks[type]={},Block.blocks[type].create=arguments[1],void 0!=arguments[2]&&null!=arguments[2]&&"function"==typeof arguments[2]&&(Block.blocks[type].load=arguments[2]),!0;var Is=Block.is;if(Is.unset(type)&&(type="block"),1==marking)marking=type;else if(Is.unset(marking)||0==marking){for(marking=Math.floor(1e3*Math.random()+1);Is.obj(children[marking]);)marking=Math.floor(1e3*Math.random()+1);marking="_"+marking.toString()}if(block={block:!0,add:function(){var e=[].slice.call(arguments),t=null;if(Is.set(e[0])&&e[0].block!==!0){e.length>=3&&(t=e[2],e=e.slice(0,2));var n=Block.apply(Block,e)}else{e.length>=2&&(t=e[1],e=e.slice(0,1));var n=e[0]}return children[n.mark()]=n,n.parent(this),Is.obj(addblock)&&addblock.block?addblock.add(n,t):Is.str(t)&&Is.obj(children[t])&&children[t].block?element.insertBefore(n.node(),children[t].node()):element.appendChild(n.node()),this},__add:function(){var e=[].slice.call(arguments),t=null;if(Is.set(e[0])&&e[0].block!==!0){e.length>=3&&(t=e[2],e=e.slice(0,2));var n=Block.apply(Block,e)}else{e.length>=2&&(t=e[1],e=e.slice(0,1));var n=e[0]}return __children[n.mark()]=n,n.__parent(this),Is.obj(__addblock)&&__addblock.block?addblock.__add(n,t):Is.str(t)&&Is.obj(__children[t])&&__children[t].block?element.insertBefore(n.node(),__children[t].node()):element.appendChild(n.node()),this},setAdd:function(e){return Is.obj(e)&&e.block&&(addblock=e),this},__setAdd:function(e){return Is.obj(e)&&e.block&&(__addblock=e),this},remove:function(){return $marking=arguments[0],Is["null"]($marking)&&Is.undef($marking)&&Is["null"](parent)&&Is.undef(parent)?parent.remove(marking):Is.str($marking)&&!Is["null"](children[$marking])&&(Is.obj(addblock)&&addblock.block?addblock.node().removeChild(children[$marking].node()):element.removeChild(children[$marking].node()),delete children[$marking]),this},__remove:function(){return $marking=arguments[0],Is["null"]($marking)&&Is.undef($marking)&&Is["null"](__parent)&&Is.undef(__parent)?__parent.__remove(marking):Is.str($marking)&&!Is["null"](__children[$marking])&&(Is.obj(__addblock)&&__addblock.block?__addblock.node().removeChild(__children[$marking].node()):element.removeChild(__children[$marking].node()),delete __children[$marking]),this},empty:function(){for(var e in children)this.remove(e);return this},__empty:function(){for(var e in children)this.remove(e);return this},type:function(){var e=arguments[0];return Is.str(e)?(Is.set(Block.blocks[e])&&(type=e),this):type},"class":function(){return Is.str(arguments[0])?(element.className+=" "+arguments[0],this):element.className},id:function(){return Is.str(arguments[0])?(element.id=arguments[0],this):element.id},mark:function(){var e=arguments[0];return Is.str(e)?("css"==e?console.warn("[BLOCK] cannot mark as '"+e+"' (reserved)"):marking=e,this):marking},attribute:function(e){var t=arguments[1];return Is.str(t)?(element.setAttribute(e,t),this):element.getAttribute(e)},css:function(){var e=arguments[0];if(Is.obj(e))for($p in e)e.hasOwnProperty($p)&&Is.str(e[$p])&&(element.style[$p]=e[$p]);else{if(!Is.str(e)){var t={},n=element.style;for($prop in n)!n.hasOwnProperty($prop)||""==n[$prop]||!isNaN(parseFloat($prop))&&isFinite($prop)||(t[$prop]=n[$prop]);return t}if($value=arguments[1],!Is.str($value))return element.style[e];element.style[e]=$value}return this},key:function(e){return $data=arguments[1],Is.unset($data)?Is.unset(keys[e])?null:keys[e]:(keys[e]=$data,this)},blockdata:function(e){return Is.unset(blockdata[e])?null:blockdata[e]},on:function(e,t){var n=this;if(Is.str(e))if(Is.func(t))if($newCallback=function(e){e.detail;Is.unset(e.detail)?t(e,n,{}):t(e,n,e.detail)},Is.str(arguments[2])){var r=arguments[2],a=e+"_"+r;Is.obj(events[e])||(events[e]={}),events[e][r]=function(e){$newCallback(e)},element.addEventListener(a,events[e][r],!1),events[a]=function(t){var a=t.detail;Is.unset(t.detail)?n.on(e,r,{}):n.on(e,r,a)},element.addEventListener(e,events[a],!1)}else element.addEventListener(e,$newCallback,!1);else a=Is.str(t)?e+"_"+t:e,$data=arguments[arguments.length-1],(Is.unset($data)||!Is.obj($data))&&($data={}),window.CustomEvent?($event=new CustomEvent(a,{detail:$data,bubbles:!0,cancelable:!0}),element.dispatchEvent($event)):document.createEvent?($event=document.createEvent("Event"),$event.initEvent(a,!0,!0,$data),element.dispatchEvent($event)):document.createEventObject?($event=document.createEventObject(),$event.eventType=a,$event.detail=$data,element.fireEvent("on"+a,$event),console.warn("Event bubbling and data not fully supported")):console.warn("Events not fully supported");return this},off:function(e,t){var n=events[e+"_"+t],r=null;return Is.set(events[e])&&(r=events[e][t]),Is.func(n)&&(events[e+"_"+t]=null,element.removeEventListener(e,n)),Is.func(r)&&(events[e][t]=null,element.removeEventListener(e+"_"+t,r)),this},child:function(e){if(Is.str(e)){if(!e.includes("/"))return Is.set(children[e])?children[e]:null;var t=e.substring(0,e.indexOf("/"));if(Is.set(children[t]))return children[t].child(e.substring(e.indexOf("/")+1))}return null},children:function(){return children},childCount:function(){var e=0;for(var t in children)e++;return e},__child:function(e){return Is.str(e)?e.includes("/")?__children[e.substring(0,e.indexOf("/"))].__child(e.substring(e.indexOf("/")+1)):Is.set(__children[e])?__children[e]:null:null},__children:function(){return __children},__childCount:function(){var e=0;for(var t in __children)e++;return e},sibling:function(e){return null!=parent&&void 0!=parent?parent.child(e):null},siblings:function(){return null!=parent&&void 0!=parent?parent.children():null},siblingCount:function(){return null!=parent&&void 0!=parent?parent.childCount():null},__sibling:function(e){return null!=__parent&&void 0!=__parent?__parent.__child(e):null},__siblings:function(){return null!=__parent&&void 0!=__parent?__parent.__children():null},__siblingCount:function(){return null!=__parent&&void 0!=__parent?__parent.__childCount():null},parent:function(){var e=arguments[0];return Is.obj(e)&&e.block&&Is.unset(parent)?(parent=e,this):Is["int"](e)&&Is.set(e)?0==e?parent:parent.parent(e-1):Is.unset(parent)?null:parent},__parent:function(){var e=arguments[0];return Is.obj(e)&&e.block&&Is.unset(__parent)?(__parent=e,this):Is["int"](e)&&Is.set(__parent)?0==e?__parent:__parent.__parent(e-1):Is.unset(__parent)?null:__parent},html:function(){var e=arguments[0],t=arguments[1];return Is.str(e)?(Is.set(t)&&t===!0?element.innerHTML+=e:element.innerHTML=e,this):element.innerHTML},node:function(){return element},fill:function(e){return Is.obj(e)&&e.block?(e.empty(),e=e.node()):Is.str(e)&&(e=document.querySelector(e)),Is.elem(e)&&(e.innerHTML="",e.appendChild(element)),this},jQuery:function(){if(Block.jQuery){var e=this;return jQuery.extend(jQuery(element),{block:function(){return e}})}return console.warn("jQuery not detected"),null},$:function(){return this.jQuery()},query:function(e,t){if(Is.str(e)){var n;if(Is.func(t))n=t.toString().match(/function[^{]+\{([\s\S]*)\}$/)[1];else{if(!Is.str(t))return this;n=t}$objectToEnd=e,$propertyToEnd=$objectToEnd.substring($objectToEnd.search(/ /)+1),$conditionToEnd=$propertyToEnd.substring($propertyToEnd.search(/ /)+1),$object=$objectToEnd.substring(0,$objectToEnd.search(/ /)).trim(),$property=$propertyToEnd.substring(0,$propertyToEnd.search(/ /)).trim(),$condition=$conditionToEnd.trim(),"window"==$object&&("height"==$property?$property="innerHeight":"width"==$property&&($property="innerWidth")),n="if ("+$object+"."+$property+" "+$condition+") { "+n+" }",Is.obj(mediaQueries[$object])?Is.arr(mediaQueries[$object][$property])||(mediaQueries[$object][$property]=[]):(mediaQueries[$object]={},mediaQueries[$object][$property]=[]),mediaQueries[$object][$property].unshift(n)}return this},data:function($blockdata){var $data={},$style={},$reservedAttributes=[];if(Is.obj($blockdata)){if($reservedAttributes.push("__keyOrder"),Is.arr($blockdata.__keyOrder))var $iterableKeys=$blockdata.__keyOrder;else var $iterableKeys=Object.keys($blockdata);for(var $j=0;$j<$iterableKeys.length;$j++){var $key=$iterableKeys[$j];if($blockdata.hasOwnProperty($key)){var $midspace=$key.search(/ /);if("css"==$key)$style=$blockdata.css,$reservedAttributes.push("css");else if("__js"==$key)eval("$jsCallback = function (event, block, data) { "+$blockdata.__js+" }"),this.on("__temp_event",$jsCallback,"__rand"),this.on("__temp_event","__rand"),this.off("__temp_event","__rand"),$reservedAttributes.push("__js");else if(":"==$key.substring(0,1))$reservedAttributes.push($key),$dataToLoad=$blockdata[$key],$eventCallback="",Is.str($dataToLoad.__js)&&($eventCallback+=$dataToLoad.__js,delete $dataToLoad.__js),Is.set($dataToLoad)&&($dataToLoad=JSON.stringify($dataToLoad),Is.str(arguments[1])?$eventCallback+=" block.data("+$dataToLoad+', "'+arguments[1]+'");':$eventCallback+=" block.data("+$dataToLoad+");"),eval("$eventCallback = function (event, block, data) {\n"+$eventCallback+"\n};"),$eventTypes=$key.substring(1).split(","),$eventTypes.forEach(function(e){this.on(e.trim(),$eventCallback)},this);else if("@"==$key.substring(0,1))$reservedAttributes.push($key),$key.length>6&&"query"==$key.substring(1,6)&&($dataToLoad=$blockdata[$key],$callbackJS="",Is.str($dataToLoad.__js)&&($callbackJS+=$dataToLoad.__js,delete $dataToLoad.__js),Is.set($dataToLoad)&&($dataToLoad=JSON.stringify($dataToLoad),Is.str(arguments[1])?$callbackJS+=" block.data("+$dataToLoad+', "'+arguments[1]+'");':$callbackJS+=" block.data("+$dataToLoad+");"),$query=$key.substring(7),this.query($query,$callbackJS));else if("$"==$key.substring(0,1))$reservedAttributes.push($key),this.key($key.substring(1),$blockdata[$key]);else if($midspace>0){var $childtype=$key.substring(0,$midspace),$childmarking=$key.substring($midspace+1),$childblock=Block($childtype,$childmarking);Is.obj($blockdata[$key])&&(Is.str(arguments[1])?$childblock.data($blockdata[$key],arguments[1]):$childblock.data($blockdata[$key]),$reservedAttributes.push($key)),this.add($childblock,Is.set($iterableKeys[$j+1])?$iterableKeys[$j+1]:null),$reservedAttributes.push($key)}else Is.obj($blockdata[$key])&&Is.obj(children[$key])?(Is.str(arguments[1])?children[$key].data($blockdata[$key],arguments[1]):children[$key].data($blockdata[$key]),$reservedAttributes.push($key)):(Is.obj($blockdata[$key])&&$reservedAttributes.push($key),$data[$key]=$blockdata[$key])}}}else if(Is.str($blockdata)||Is["int"]($blockdata))$data={val:$blockdata};else{if(!Is["null"]($blockdata)&&Is.obj($blockdata))return this;$data={}}if("block"!=type&&Is.set(Block.blocks[type])){var $getData=function(e,t){var n;return"this"==e?n=$data:Is.unset($data[e])?n=null:($reservedAttributes.push(e),n=$data[e]),Is.func(t)&&Is.set(n)&&t(n),n},$getStyle=function(e,t){var n;return n="this"==e?$style:Is.unset($style[e])?null:$style[e],Is.func(t,"function")&&Is.set(n)&&t(n),n};Block.blocks[type].load(this,$getData,$getStyle)}for($property in $style)$style.hasOwnProperty($property)&&(element.style[$property]=$style[$property]);for($key in dataBindings)dataBindings.hasOwnProperty($key)&&$data.hasOwnProperty($key)&&dataBindings[$key]($data[$key],this);for($key in $data)$data.hasOwnProperty($key)&&!Block.inArr($key,$reservedAttributes)&&element.setAttribute($key,$data[$key]);return blockdata.count++,blockdata[Is.str(arguments[1])?arguments[1]:"#"+blockdata.count]={data:$data,css:$style},this},bind:function(e,t){return Is.str(e)&&Is.func(t)&&(dataBindings[e]=t),this},parse:function(e,t){t=t.replace(/\r\n|\r|\n/g,"\n");var n=t.substring(0,t.indexOf("*")),r=Block.parse(t.substring(t.indexOf("*")+2),n);return arguments[arguments.length-1]===!0?r:(Is.str(arguments[2])?this.data(r[marking],arguments[2]):this.data(r[marking]),Is.func(e)&&e(this),this)},load:function(e,t){var n=this,r=function(e,r){n.parse.apply(n,[e,r,t])},a=arguments[2],s=arguments[3];if((null==s||void 0==s)&&(s=!0),Is.str(a)&&"jquery"===a.toLowerCase())Block.jQuery?jQuery.ajax({url:t+".block",type:"GET",async:s,success:function(t){r(e,t)}}):console.warn("jQuery not detected");else if(a===!0){var l;l=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP"),l.onreadystatechange=function(){4==l.readyState&&200==l.status&&r(e,l.responseText)},l.open("GET",t+".block",s),l.send()}else r(e,customBlockData[t]);return this}},"block"==type){element=Block.node("div"),block.css({width:"100%",height:"100%",display:"table",textAlign:"center"});var content=Block("div")["class"]("content").mark("content");content.css({display:"table-cell",textAlign:"center",verticalAlign:"middle",margin:"0 auto"}),block.setAdd(content),block.__add(content)}else null!=Block.blocks[type]?(block=Block.blocks[type].create(),block.type(type),block.mark(marking)):element=Block.node(type);return block.attribute("block",marking),$resizeCallback=function($e){$callback="";for($objectName in mediaQueries)if(mediaQueries.hasOwnProperty($objectName)){$object=mediaQueries[$objectName];for($propertyName in $object)if($object.hasOwnProperty($propertyName)){$property=$object[$propertyName];for($i in $property)0==$i?$callback+=" "+$property[$i]:$callback+=" else "+$property[$i]}}eval("$callback = function (event, block, data) { "+$callback+" };"),Is.unset($e.detail)?$callback($e,block,{}):$callback($e,block,$e.detail)},window.addEventListener("blockjs_query",$resizeCallback),block},Block.is={"null":function(e){return null==e},eqnull:function(e){return null===e},undef:function(e){return void 0==e},set:function(e){return void 0!=e&&null!==e},unset:function(e){return void 0==e||null===e},str:function(e){return null!==e&&void 0!=e&&("string"==typeof e||e instanceof String)},func:function(e){return null!==e&&void 0!=e&&("function"==typeof e||e instanceof Function)},elem:function(e){return null!==e&&void 0!=e&&("object"==typeof e||e instanceof Object)&&e instanceof Node&&e instanceof Element},arr:function(e){return null!==e&&void 0!=e&&("array"==typeof e||e instanceof Array)},obj:function(e){return null!==e&&void 0!=e&&("object"==typeof e||e instanceof Object)},"int":function(e){return null!==e&&void 0!=e&&e===parseInt(e,10)&&!isNaN(e)},type:function(e,t){return typeof e==t}},Block.node=function(e){return document.createElement(e)},Block.inArr=function(e,t){return t.indexOf(e)>-1},Block.set=function(e,t,n){return 1==t.length?(e[t[0]]=n,e):t.length>1?Block.set(e[t[0]],t.slice(1),n):void 0},Block.get=function(e,t){return 1==t.length?e[t[0]]:t.length>1?Block.get(e[t[0]],t.slice(1)):void 0},Block.parse=function(e,t){for(var n={},r=[],a=e.split("\n"),s=0;s<a.length;s++){var l=a[s],o=l.search(/\S/);if(-1!=o&&"//"!=l.substring(o,o+2)){l=l.substring(0,o)+l.substring(o).trim();var i=(l.match(new RegExp(t,"g"))||[]).length;l=l.trim();var c=l.search(/ /);if(-1==c||":"==l.substring(0,1)||"@"==l.substring(0,1)){var u=l,d={};if("{"==u){for(var $="",k=s+1;k<a.length;k++){var b=a[k],p=(b.search(/\S/),(b.match(new RegExp(t,"g"))||[]).length);if(b=b.trim(),"}"==b&&p==i)break;$+=b+"\n "}s=k,u="__js",d=$}}else if(Block.is.str(a[s+1])&&o<a[s+1].search(/\S/))var u=l,d={};else var u=l.substring(0,c),d=l.substring(c+1);r=r.slice(0,i);var f=r.concat(["__keyOrder"]);Block.is.arr(Block.get(n,f))?Block.get(n,f).push(u):Block.set(n,f,[u]),r.push(u),Block.set(n,r,d)}}return n},Block.jQuery=!1;try{Block.jQuery="function"==typeof jQuery||"function"==typeof window.jQuery}catch(error){Block.jQuery=!1}Block.blocks={},Block.queries=function(e){"on"===e?window.addEventListener("resize",Block.queryListener):"off"===e?window.removeEventListener("resize",Block.queryListener):window.dispatchEvent(new CustomEvent("blockjs_query"))},Block.queryListener=function(){Block.queries()},Block.queries("on");
